<h1>
  <%= @article.get_title %>
</h1>

<div class="field">
  <%= author_label @article %>
</div>

<div class="grey">
  <div class="field">
    Created at <%= @article.created_at %>
  </div>

  <div class="field">
    Last updated at <%= @article.updated_at %>
  </div>

  <div class="field">
    View count: <%= @article.views %>
  </div>
</div>

<% if current_user&.has_permission? @article %>
  <% if current_user != @article.owner && current_user.admin? %>
    <% edit_msg = "Edit article as admin" %>
    <% delete_msg = "Delete article as admin" %>
  <% else %>
    <% edit_msg = "Edit article" %>
    <% delete_msg = "Delete article" %>
  <% end %>

  <br>
  <%= link_to edit_msg, edit_article_path(@article) %>
  <br>
  <%= link_to delete_msg, article_path(@article), method: :delete %>
<% end %>

<% unless @article.tags.empty? %>
  <div class="ui message">
    <h2>Tags</h2>
    <div class="ui list">
      <% @article.tags.find_each do |tag| %>
        <div class="item">
          <%= render "tags/tag", tag: tag %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<% tldr = @article.get_tldr %>
<% tldr_image = @article.tldr_image.attachment %>

<% unless tldr.nil? && tldr_image.nil? %>
  <div class="ui segment">
    <h2>tldr</h2>
    <%= tldr %>
    <% unless tldr_image.nil? %>
      <%= image_tag(@article.tldr_image.attachment, class: "image") %>
    <% end %>
  </div>
<% end %>

<%= @article.get_body %>
