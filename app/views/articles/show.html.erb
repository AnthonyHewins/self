<h1>
  <%= @article.get_title %>
</h1>

<div class="field">
  <%= author_label @article %>
</div>

<div class="grey">
  <div class="field">
    Created at <%= @article.created_at %>
  </div>

  <div class="field">
    Last updated at <%= @article.updated_at %>
  </div>

  <div class="field">
    View count: <%= @article.views %>
  </div>
</div>

<% if current_user&.has_permission? @article %>
  <% if current_user != @article.owner && current_user.admin? %>
    <% edit_msg = "Edit article as admin" %>
    <% delete_msg = "Delete article as admin" %>
  <% else %>
    <% edit_msg = "Edit article" %>
    <% delete_msg = "Delete article" %>
  <% end %>

  <br>
  <%= link_to edit_msg, edit_article_path(@article) %>
  <br>
  <%= link_to delete_msg, article_path(@article), method: :delete %>
<% end %>

<div class="ui message">
  <h2>Tags</h2>
  <p>
    <% if @article.tags.empty? %>
      <i>None</i>
    <% else %>
      <% @article.tags.each do |article_tag| %>
        <%= render "tags/tag", tag: article_tag %>
      <% end %>
    <% end %>
  </p>
</div>

<% tldr = @article.get_tldr %>
<% tldr_image = @article.tldr_image.attachment %>

<% unless tldr.nil? && tldr_image.nil? %>
  <div class="ui segment">
    <h2>tldr</h2>
    <%= tldr %>
    <% unless tldr_image.nil? %>
      <%= image_tag(@article.tldr_image.attachment, style: "width: 100%; height: auto;") %>
    <% end %>
  </div>
<% end %>

<%= @article.get_body %>
